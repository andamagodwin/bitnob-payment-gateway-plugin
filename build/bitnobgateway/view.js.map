{"version":3,"file":"bitnobgateway/view.js","mappings":"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","sources":["webpack://bitnobgateway/./src/bitnobgateway/view.js"],"sourcesContent":["/**\n * Bitnob Gateway Frontend JavaScript\n * Handles AJAX form submission and UI interactions\n */\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const form = document.getElementById('bitnob-form');\n    const loadingDiv = document.getElementById('bitnob-loading');\n    const errorDiv = document.getElementById('bitnob-error');\n    const invoiceDiv = document.getElementById('bitnob-invoice');\n    const submitBtn = document.getElementById('bitnob-submit-btn');\n    const copyBtn = document.getElementById('copy-invoice');\n    const createAnotherBtn = document.getElementById('create-another');\n    const changeEmailBtn = document.getElementById('change-email-btn');\n    const emailInput = document.getElementById('bitnob-email');\n\n    if (!form || !window.bitnobData) return;\n\n    // Form submission handler\n    form.addEventListener('submit', async function(e) {\n        e.preventDefault();\n        \n        // Clear previous states\n        hideAllMessages();\n        clearFieldErrors();\n        \n        // Get form data\n        const formData = new FormData();\n        formData.append('action', 'bitnob_create_invoice');\n        formData.append('nonce', window.bitnobData.nonce);\n        formData.append('amount', document.getElementById('bitnob-amount').value);\n        formData.append('email', document.getElementById('bitnob-email').value);\n        formData.append('description', document.getElementById('bitnob-description').value);\n\n        // Validate form\n        if (!validateForm()) {\n            return;\n        }\n\n        // Show loading state\n        showLoading();\n        setButtonLoading(true);\n\n        try {\n            const response = await fetch(window.bitnobData.ajaxUrl, {\n                method: 'POST',\n                body: formData\n            });\n\n            const result = await response.json();\n\n            if (result.success) {\n                showInvoice(result.data);\n            } else {\n                showError(result.data || 'An error occurred while creating the invoice.');\n            }\n        } catch (error) {\n            console.error('AJAX Error:', error);\n            showError('Network error. Please check your connection and try again.');\n        } finally {\n            hideLoading();\n            setButtonLoading(false);\n        }\n    });\n\n    // Copy to clipboard functionality\n    if (copyBtn) {\n        copyBtn.addEventListener('click', function() {\n            const invoiceRequest = document.getElementById('invoice-request').textContent;\n            \n            navigator.clipboard.writeText(invoiceRequest).then(function() {\n                // Show success feedback\n                const originalText = copyBtn.querySelector('.copy-text').textContent;\n                copyBtn.querySelector('.copy-text').textContent = 'Copied!';\n                copyBtn.classList.add('copied');\n                \n                setTimeout(function() {\n                    copyBtn.querySelector('.copy-text').textContent = originalText;\n                    copyBtn.classList.remove('copied');\n                }, 2000);\n            }).catch(function(err) {\n                console.error('Failed to copy: ', err);\n                // Fallback for older browsers\n                fallbackCopyTextToClipboard(invoiceRequest);\n            });\n        });\n    }\n\n    // Create another invoice\n    if (createAnotherBtn) {\n        createAnotherBtn.addEventListener('click', function() {\n            hideAllMessages();\n            form.style.display = 'block';\n            form.reset();\n            \n            // Restore user email if logged in\n            if (window.bitnobData.user.isLoggedIn) {\n                setTimeout(() => {\n                    emailInput.value = window.bitnobData.user.email;\n                    emailInput.setAttribute('readonly', 'readonly');\n                    emailInput.removeAttribute('required');\n                    if (changeEmailBtn) {\n                        changeEmailBtn.textContent = 'Change';\n                    }\n                    // Reset visual styling\n                    emailInput.style.borderColor = '#333';\n                    emailInput.style.backgroundColor = '#2c2c2e';\n                }, 0);\n            }\n            \n            document.getElementById('bitnob-description').value = 'Lightning payment';\n        });\n    }\n\n    // Change email functionality for logged-in users\n    if (changeEmailBtn && window.bitnobData.user.isLoggedIn) {\n        changeEmailBtn.addEventListener('click', function() {\n            const currentlyReadonly = emailInput.hasAttribute('readonly');\n            \n            if (currentlyReadonly) {\n                // Enable editing\n                emailInput.removeAttribute('readonly');\n                emailInput.focus();\n                emailInput.select();\n                emailInput.setAttribute('required', 'required');\n                changeEmailBtn.textContent = 'Restore';\n                \n                // Add visual indication\n                emailInput.style.borderColor = '#f7931a';\n                emailInput.style.backgroundColor = '#2c2c2e';\n            } else {\n                // Restore original email\n                emailInput.value = window.bitnobData.user.email;\n                emailInput.setAttribute('readonly', 'readonly');\n                emailInput.removeAttribute('required');\n                changeEmailBtn.textContent = 'Change';\n                \n                // Remove visual indication\n                emailInput.style.borderColor = '#333';\n                emailInput.style.backgroundColor = '#2c2c2e';\n            }\n        });\n\n        // Handle form reset to restore original email\n        form.addEventListener('reset', function() {\n            if (window.bitnobData.user.isLoggedIn) {\n                setTimeout(() => {\n                    emailInput.value = window.bitnobData.user.email;\n                    emailInput.setAttribute('readonly', 'readonly');\n                    emailInput.removeAttribute('required');\n                    if (changeEmailBtn) {\n                        changeEmailBtn.textContent = 'Change';\n                    }\n                }, 0);\n            }\n        });\n    }\n\n    // Utility functions\n    function validateForm() {\n        let isValid = true;\n        \n        const amount = document.getElementById('bitnob-amount');\n        const email = document.getElementById('bitnob-email');\n\n        if (!amount.value || parseInt(amount.value) < 1) {\n            showFieldError('amount-error', 'Please enter a valid amount (minimum 1 satoshi)');\n            isValid = false;\n        }\n\n        // Only validate email if it's not readonly (i.e., user is not logged in or has chosen to change email)\n        if (!email.hasAttribute('readonly')) {\n            if (!email.value || !isValidEmail(email.value)) {\n                showFieldError('email-error', 'Please enter a valid email address');\n                isValid = false;\n            }\n        } else if (window.bitnobData.user.isLoggedIn && !email.value) {\n            // This shouldn't happen, but just in case\n            showFieldError('email-error', 'Email is required');\n            isValid = false;\n        }\n\n        return isValid;\n    }\n\n    function isValidEmail(email) {\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        return emailRegex.test(email);\n    }\n\n    function showFieldError(elementId, message) {\n        const errorElement = document.getElementById(elementId);\n        if (errorElement) {\n            errorElement.textContent = message;\n            errorElement.style.display = 'block';\n        }\n    }\n\n    function clearFieldErrors() {\n        const errorElements = document.querySelectorAll('.bitnob-field-error');\n        errorElements.forEach(element => {\n            element.textContent = '';\n            element.style.display = 'none';\n        });\n    }\n\n    function showLoading() {\n        loadingDiv.style.display = 'block';\n        form.style.display = 'none';\n    }\n\n    function hideLoading() {\n        loadingDiv.style.display = 'none';\n    }\n\n    function showError(message) {\n        errorDiv.textContent = message;\n        errorDiv.style.display = 'block';\n        form.style.display = 'block';\n    }\n\n    function showInvoice(data) {\n        // Populate invoice data\n        document.getElementById('invoice-amount').textContent = data.amount.toLocaleString();\n        document.getElementById('invoice-description').textContent = data.description;\n        document.getElementById('invoice-request').textContent = data.request;\n        document.getElementById('invoice-qr').src = data.qr_url;\n\n        // Show invoice section\n        invoiceDiv.style.display = 'block';\n        form.style.display = 'none';\n\n        // Show success message for logged-in users\n        if (window.bitnobData.user.isLoggedIn) {\n            showSuccessMessage(`Invoice created for ${window.bitnobData.user.displayName}`);\n        }\n    }\n\n    function showSuccessMessage(message) {\n        // Create a temporary success message\n        const successMsg = document.createElement('div');\n        successMsg.className = 'bitnob-success-message';\n        successMsg.innerHTML = `\n            <div class=\"success-icon\">✅</div>\n            <div class=\"success-text\">${message}</div>\n        `;\n        \n        invoiceDiv.insertBefore(successMsg, invoiceDiv.firstChild);\n        \n        // Remove after 5 seconds\n        setTimeout(() => {\n            if (successMsg.parentNode) {\n                successMsg.parentNode.removeChild(successMsg);\n            }\n        }, 5000);\n    }\n\n    function hideAllMessages() {\n        errorDiv.style.display = 'none';\n        invoiceDiv.style.display = 'none';\n        loadingDiv.style.display = 'none';\n    }\n\n    function setButtonLoading(loading) {\n        const btnText = submitBtn.querySelector('.btn-text');\n        const btnLoading = submitBtn.querySelector('.btn-loading');\n        \n        if (loading) {\n            btnText.style.display = 'none';\n            btnLoading.style.display = 'flex';\n            submitBtn.disabled = true;\n        } else {\n            btnText.style.display = 'block';\n            btnLoading.style.display = 'none';\n            submitBtn.disabled = false;\n        }\n    }\n\n    function fallbackCopyTextToClipboard(text) {\n        const textArea = document.createElement(\"textarea\");\n        textArea.value = text;\n        \n        // Avoid scrolling to bottom\n        textArea.style.top = \"0\";\n        textArea.style.left = \"0\";\n        textArea.style.position = \"fixed\";\n\n        document.body.appendChild(textArea);\n        textArea.focus();\n        textArea.select();\n\n        try {\n            const successful = document.execCommand('copy');\n            if (successful) {\n                copyBtn.querySelector('.copy-text').textContent = 'Copied!';\n                copyBtn.classList.add('copied');\n                \n                setTimeout(function() {\n                    copyBtn.querySelector('.copy-text').textContent = 'Copy';\n                    copyBtn.classList.remove('copied');\n                }, 2000);\n            }\n        } catch (err) {\n            console.error('Fallback: Oops, unable to copy', err);\n        }\n\n        document.body.removeChild(textArea);\n    }\n});\n"],"names":["document","addEventListener","form","getElementById","loadingDiv","errorDiv","invoiceDiv","submitBtn","copyBtn","createAnotherBtn","changeEmailBtn","emailInput","window","bitnobData","e","preventDefault","hideAllMessages","clearFieldErrors","formData","FormData","append","nonce","value","validateForm","showLoading","setButtonLoading","response","fetch","ajaxUrl","method","body","result","json","success","showInvoice","data","showError","error","console","hideLoading","invoiceRequest","textContent","navigator","clipboard","writeText","then","originalText","querySelector","classList","add","setTimeout","remove","catch","err","fallbackCopyTextToClipboard","style","display","reset","user","isLoggedIn","email","setAttribute","removeAttribute","borderColor","backgroundColor","currentlyReadonly","hasAttribute","focus","select","isValid","amount","parseInt","showFieldError","isValidEmail","emailRegex","test","elementId","message","errorElement","errorElements","querySelectorAll","forEach","element","toLocaleString","description","request","src","qr_url","showSuccessMessage","displayName","successMsg","createElement","className","innerHTML","insertBefore","firstChild","parentNode","removeChild","loading","btnText","btnLoading","disabled","text","textArea","top","left","position","appendChild","successful","execCommand"],"sourceRoot":""}