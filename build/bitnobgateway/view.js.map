{"version":3,"file":"bitnobgateway/view.js","mappings":"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","sources":["webpack://bitnobgateway/./src/bitnobgateway/view.js"],"sourcesContent":["/**\n * Bitnob Gateway Frontend JavaScript\n * Handles AJAX form submission and UI interactions\n */\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const form = document.getElementById('bitnob-form');\n    const loadingDiv = document.getElementById('bitnob-loading');\n    const errorDiv = document.getElementById('bitnob-error');\n    const invoiceDiv = document.getElementById('bitnob-invoice');\n    const submitBtn = document.getElementById('bitnob-submit-btn');\n    const copyBtn = document.getElementById('copy-invoice');\n    const createAnotherBtn = document.getElementById('create-another');\n\n    if (!form || !window.bitnobData) return;\n\n    // Form submission handler\n    form.addEventListener('submit', async function(e) {\n        e.preventDefault();\n        \n        // Clear previous states\n        hideAllMessages();\n        clearFieldErrors();\n        \n        // Get form data\n        const formData = new FormData();\n        formData.append('action', 'bitnob_create_invoice');\n        formData.append('nonce', window.bitnobData.nonce);\n        formData.append('amount', document.getElementById('bitnob-amount').value);\n        formData.append('email', document.getElementById('bitnob-email').value);\n        formData.append('description', document.getElementById('bitnob-description').value);\n\n        // Validate form\n        if (!validateForm()) {\n            return;\n        }\n\n        // Show loading state\n        showLoading();\n        setButtonLoading(true);\n\n        try {\n            const response = await fetch(window.bitnobData.ajaxUrl, {\n                method: 'POST',\n                body: formData\n            });\n\n            const result = await response.json();\n\n            if (result.success) {\n                showInvoice(result.data);\n            } else {\n                showError(result.data || 'An error occurred while creating the invoice.');\n            }\n        } catch (error) {\n            console.error('AJAX Error:', error);\n            showError('Network error. Please check your connection and try again.');\n        } finally {\n            hideLoading();\n            setButtonLoading(false);\n        }\n    });\n\n    // Copy to clipboard functionality\n    if (copyBtn) {\n        copyBtn.addEventListener('click', function() {\n            const invoiceRequest = document.getElementById('invoice-request').textContent;\n            \n            navigator.clipboard.writeText(invoiceRequest).then(function() {\n                // Show success feedback\n                const originalText = copyBtn.querySelector('.copy-text').textContent;\n                copyBtn.querySelector('.copy-text').textContent = 'Copied!';\n                copyBtn.classList.add('copied');\n                \n                setTimeout(function() {\n                    copyBtn.querySelector('.copy-text').textContent = originalText;\n                    copyBtn.classList.remove('copied');\n                }, 2000);\n            }).catch(function(err) {\n                console.error('Failed to copy: ', err);\n                // Fallback for older browsers\n                fallbackCopyTextToClipboard(invoiceRequest);\n            });\n        });\n    }\n\n    // Create another invoice\n    if (createAnotherBtn) {\n        createAnotherBtn.addEventListener('click', function() {\n            hideAllMessages();\n            form.style.display = 'block';\n            form.reset();\n            document.getElementById('bitnob-description').value = 'Lightning payment';\n        });\n    }\n\n    // Utility functions\n    function validateForm() {\n        let isValid = true;\n        \n        const amount = document.getElementById('bitnob-amount');\n        const email = document.getElementById('bitnob-email');\n\n        if (!amount.value || parseInt(amount.value) < 1) {\n            showFieldError('amount-error', 'Please enter a valid amount (minimum 1 satoshi)');\n            isValid = false;\n        }\n\n        if (!email.value || !isValidEmail(email.value)) {\n            showFieldError('email-error', 'Please enter a valid email address');\n            isValid = false;\n        }\n\n        return isValid;\n    }\n\n    function isValidEmail(email) {\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        return emailRegex.test(email);\n    }\n\n    function showFieldError(elementId, message) {\n        const errorElement = document.getElementById(elementId);\n        if (errorElement) {\n            errorElement.textContent = message;\n            errorElement.style.display = 'block';\n        }\n    }\n\n    function clearFieldErrors() {\n        const errorElements = document.querySelectorAll('.bitnob-field-error');\n        errorElements.forEach(element => {\n            element.textContent = '';\n            element.style.display = 'none';\n        });\n    }\n\n    function showLoading() {\n        loadingDiv.style.display = 'block';\n        form.style.display = 'none';\n    }\n\n    function hideLoading() {\n        loadingDiv.style.display = 'none';\n    }\n\n    function showError(message) {\n        errorDiv.textContent = message;\n        errorDiv.style.display = 'block';\n        form.style.display = 'block';\n    }\n\n    function showInvoice(data) {\n        // Populate invoice data\n        document.getElementById('invoice-amount').textContent = data.amount.toLocaleString();\n        document.getElementById('invoice-description').textContent = data.description;\n        document.getElementById('invoice-request').textContent = data.request;\n        document.getElementById('invoice-qr').src = data.qr_url;\n\n        // Show invoice section\n        invoiceDiv.style.display = 'block';\n        form.style.display = 'none';\n    }\n\n    function hideAllMessages() {\n        errorDiv.style.display = 'none';\n        invoiceDiv.style.display = 'none';\n        loadingDiv.style.display = 'none';\n    }\n\n    function setButtonLoading(loading) {\n        const btnText = submitBtn.querySelector('.btn-text');\n        const btnLoading = submitBtn.querySelector('.btn-loading');\n        \n        if (loading) {\n            btnText.style.display = 'none';\n            btnLoading.style.display = 'flex';\n            submitBtn.disabled = true;\n        } else {\n            btnText.style.display = 'block';\n            btnLoading.style.display = 'none';\n            submitBtn.disabled = false;\n        }\n    }\n\n    function fallbackCopyTextToClipboard(text) {\n        const textArea = document.createElement(\"textarea\");\n        textArea.value = text;\n        \n        // Avoid scrolling to bottom\n        textArea.style.top = \"0\";\n        textArea.style.left = \"0\";\n        textArea.style.position = \"fixed\";\n\n        document.body.appendChild(textArea);\n        textArea.focus();\n        textArea.select();\n\n        try {\n            const successful = document.execCommand('copy');\n            if (successful) {\n                copyBtn.querySelector('.copy-text').textContent = 'Copied!';\n                copyBtn.classList.add('copied');\n                \n                setTimeout(function() {\n                    copyBtn.querySelector('.copy-text').textContent = 'Copy';\n                    copyBtn.classList.remove('copied');\n                }, 2000);\n            }\n        } catch (err) {\n            console.error('Fallback: Oops, unable to copy', err);\n        }\n\n        document.body.removeChild(textArea);\n    }\n});\n"],"names":["document","addEventListener","form","getElementById","loadingDiv","errorDiv","invoiceDiv","submitBtn","copyBtn","createAnotherBtn","window","bitnobData","e","preventDefault","hideAllMessages","clearFieldErrors","formData","FormData","append","nonce","value","validateForm","showLoading","setButtonLoading","response","fetch","ajaxUrl","method","body","result","json","success","showInvoice","data","showError","error","console","hideLoading","invoiceRequest","textContent","navigator","clipboard","writeText","then","originalText","querySelector","classList","add","setTimeout","remove","catch","err","fallbackCopyTextToClipboard","style","display","reset","isValid","amount","email","parseInt","showFieldError","isValidEmail","emailRegex","test","elementId","message","errorElement","errorElements","querySelectorAll","forEach","element","toLocaleString","description","request","src","qr_url","loading","btnText","btnLoading","disabled","text","textArea","createElement","top","left","position","appendChild","focus","select","successful","execCommand","removeChild"],"sourceRoot":""}